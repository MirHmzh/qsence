<!DOCTYPE html>
<html>
<head>
	<title>ASIAP - CLIENT PRESENSI</title>
	<link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="assets/font/Poppins-Regular.ttf">
	<link rel="stylesheet" type="text/css" href="assets/css/globalstyle.css">
	<link rel="stylesheet" type="text/css" href="assets/css/client.css">
	<link rel="stylesheet" type="text/css" href="assets/css/sweetalert.min.css">
	<link rel="shortcut icon" href="assets/maskot.png" type="image/x-icon">
	<link rel="icon" href="assets/maskot.png" type="image/x-icon">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>
<body>
	<nav class="navbar navbar-expand-lg navbar-light">
	<a class="navbar-brand" href="#">
		<img src="assets/img/logo.png" class="logo" alt="">
	</a>

	<div class="navbar-collapse" id="menu">
		<ul class="navbar-nav nav nav-tabs mr-auto mt-2 mt-lg-0 nav-mobile">
		<li class="nav-item" id="nav-shadow">
			<a class="nav-link">&nbsp;</a>
		</li>
		<li class="nav-item" id="active-tab" data-absen="in">
			<a class="nav-link" data-target="content-tab-checkin" data-wrapper="checkin">Check In</a>
		</li>
		<li class="nav-item" data-absen="out">
			<a class="nav-link" data-target="content-tab-checkout" data-wrapper="checkout">Check Out</a>
		</li>
		<li class="nav-item">
			<a class="nav-link" data-target="content-tab-history">History</a>
		</li>
		</ul>
		<div class="my-2 my-lg-0">
			<ul class="navbar-nav" id="profile-btn">
				<li class="nav-item text-right name-user">
					<span class="name-user">Amelia Anjayani</span>
					<span class="position-user">Marketing</span>
				</li>
				<li class="ml-2">
					<img src="assets/img/amel.png" class="img-fluid img-nav" alt="">
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<!-- Elemen Background -->
	<div id="moving-bg" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; ">
		<img class="moving1" src="assets/img/bbl1.png" style="position: absolute; left: -10%;" alt="">
		<img class="moving1" src="assets/img/bbl2.png" style="position: absolute; right: 0;" alt="">
		<img class="moving2" src="assets/img/bbl3.png" style="position: absolute; right: 30%;" alt="">
		<img class="moving2" src="assets/img/bbl4.png" style="position: absolute; right: 20%; top:10%;" alt="">
		<img class="moving3" src="assets/img/bbl5.png" style="position: absolute; left: 20%; top:5%;" alt="">
		<img class="moving3" src="assets/img/bbl6.png" style="position: absolute; right: 0; bottom:0;" alt="">
		<img class="moving4" src="assets/img/bbl7.png" style="position: absolute; right: 50%; bottom:-15%;" alt="">
		<img class="moving4" src="assets/img/bbl3.png" style="position: absolute; width: 20%; left:-5%; bottom:0;" alt="">
		<img class="moving5" src="assets/img/bbl2.png" style="position: absolute; right: 20%; bottom:-10%;" alt="">
	</div>

	<div class="container el">
		<div class="row">
			<div class="col-12">
				<div class="tab-content">
					<div class="tab-pane active" id="checkin">
						<div class="card">
							<div class="card-body no-gutters">
								<div class="row no-gutters" id="main-wrapper">
									<div class="col-sm-5 bg-white p-qr">
										<div class="barcode d-flex justify-content-center">
											<canvas id="qri" class="qri"></canvas>
										</div>
										<div class="d-flex justify-content-center">
											<button id="btn-qr" class="btn btn-primary text-center" onClick="initCam()" style="background: #7F8DFD;">Open Camera</button>
										</div>
									</div>
									<div class="col-sm-7 d-flex justify-content-center bg-blur" id="main-content">
										<div class=" align-self-center" id="content-tab-checkin">
											<h1 class="text-center title-card">Take QR Code Check In</h1>
											<h5 class="text-center date-card">Senin, 16 November 2020</h5>
											<button id="btn-qr-mobile" class="btn btn-primary text-center" onClick="initCam()" style="background: #7F8DFD;">Open Camera</button>
												<p class="text-center mt-2 caption">
													<b>TIPS :</b> Klik Tombol Open Camera, Arahkan kamera sejajar dengan QRCode dan pastikan cahaya layar cukup terang.
												</p>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div id="checkout" class="tab-pane fade">
						<div class="card" id="">
							<div class="card-body no-gutters">
								<div class="row no-gutters" id="checkout-wrapper">
									<div class="col-sm-5 bg-white p-qr">
										<div class="barcode d-flex justify-content-center">
											<canvas id="qri" class="qri"></canvas>
										</div>
										<div class="d-flex justify-content-center">
											<button id="btn-qr" class="btn btn-primary text-center" onClick="initCam()" style="background: #7F8DFD;">Open Camera</button>
										</div>
									</div>
									<div class="col-sm-7 d-flex justify-content-center bg-blur" id="main-content">
										<div class=" align-self-center" id="content-tab-checkout">
											<h1 class="text-center title-card">Take QR Code Check Out</h1>
											<h5 class="text-center date-card">Senin, 16 November 2020</h5>
											<p class="text-center mt-4 caption">
												<b>TIPS :</b> Klik Tombol Open Camera,  Arahkan kamera sejajar dengan QRCode dan pastikan cahaya layar cukup terang.
											</p>
											<button id="btn-qr-mobile" class="btn btn-primary text-center" onClick="initCam()" style="background: #7F8DFD;">Open Camera</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-pane fade" id="history">
						<div class="card">
							<div class="card-body no-gutters">
								<div class="row no-gutters" id="history-absen">
									<div class="col-12" id="card-history">
										<div class="card">
											<div class="card-body p-4">
												<div class="row">
													<div class="col-sm-6 history-date">
														<h1>Senin</h1>
														<h5>16 November 2020</h5>
													</div>
													<div class="col-sm-6">
														<div class="row">
															<div class="col-6 text-right border-right history-time">
																<h2>Check In</h2>
																<h3>08.00</h3>
															</div>
															<div class="col-6 text-left history-time">
																<h2>Check Out</h2>
																<h3>17.00</h3>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="card mt-2">
											<div class="card-body p-4">
												<div class="row">
													<div class="col-sm-6 history-date">
														<h1>Selasa</h1>
														<h5>17 November 2020</h5>
													</div>
													<div class="col-sm-6">
														<div class="row">
															<div class="col-6 text-right border-right history-time">
																<h2>Check In</h2>
																<h3>08.00</h3>
															</div>
															<div class="col-6 text-left history-time">
																<h2>Check Out</h2>
																<h3>17.00</h3>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="card mt-2">
											<div class="card-body p-4">
												<div class="row">
													<div class="col-sm-6 history-date">
														<h1>Rabu</h1>
														<h5>18 November 2020</h5>
													</div>
													<div class="col-sm-6">
														<div class="row">
															<div class="col-6 text-right border-right history-time">
																<h2>Check In</h2>
																<h3>08.00</h3>
															</div>
															<div class="col-6 text-left history-time">
																<h2>Check Out</h2>
																<h3>17.00</h3>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="card mt-2">
											<div class="card-body p-4">
												<div class="row">
													<div class="col-sm-6 history-date">
														<h1>Kamis</h1>
														<h5>19 November 2020</h5>
													</div>
													<div class="col-sm-6">
														<div class="row">
															<div class="col-6 text-right border-right history-time">
																<h2>Check In</h2>
																<h3>08.00</h3>
															</div>
															<div class="col-6 text-left history-time">
																<h2>Check Out</h2>
																<h3>17.00</h3>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="card mt-2">
											<div class="card-body p-4">
												<div class="row">
													<div class="col-sm-6 history-date">
														<h1>Jum'at</h1>
														<h5>19 November 2020</h5>
													</div>
													<div class="col-sm-6">
														<div class="row">
															<div class="col-6 text-right border-right history-time">
																<h2>Check In</h2>
																<h3>08.00</h3>
															</div>
															<div class="col-6 text-left history-time">
																<h2>Check Out</h2>
																<h3>17.00</h3>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-pane" id="amel-wrapper">
						<div class="card">
							<div class="card-body p-5" style="background: rgb(255 255 255 / 60%);">
								<div class="row" id="amel-wrapper">
									<div class="col-sm-3">
										<img src="assets/img/amel.png" class="img-fluid img-profil" alt="">
									</div>
									<div class="col-sm-9 align-self-center title-profil" >
										<h1>Amelia Anjayani</h1>
										<h5>Marketing</h5>
									</div>
								</div>
								<div class="row mt-4">
									<div class="col-6 justify-content-center text-center border-right card-profil">
										<h5 style="font-weight: 800;">ID Karyawan</h5>
										<h1 style="color:#868686">171080200</h1>
									</div>
									<div class="col-6  justify-content-center text-center card-profil">
										<h5 style="font-weight: 800;">Tingkat Keterlambatan</h5>
										<h1 style="color:#8b8b8b">20%</h1>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<footer>
		<div class="container-fluid">
			<div class="row">
				<div class="col">
					<span>@Koepeped Squad</span>
				</div>
				<div class="col text-right">
					<span>IT FEST 2020</span>
				</div>
			</div>
		</div>
	</footer>
</body>

<!-- Helper Element -->

<div class="row no-gutters" id="checkin-wrapper">
	<div class="col-sm-5 bg-white p-qr">
		<div class="barcode d-flex justify-content-center">
			<canvas id="qri" class="qri"></canvas>
		</div>
		<div class="d-flex justify-content-center">
			<button id="btn-qr" class="btn btn-primary text-center" onClick="initCam()" style="background: #7F8DFD;">Open Camera</button>
		</div>
	</div>
	<div class="col-sm-7 d-flex justify-content-center bg-blur" id="main-content">
		<div class=" align-self-center" id="content-tab-checkin">
			<h1 class="text-center title-card">Take QR Code Check In</h1>
			<h5 class="text-center date-card">Senin, 16 November 2020</h5>
			<button id="btn-qr-mobile" class="btn btn-primary text-center" onClick="initCam()" style="background: #7F8DFD;">Open Camera</button>
			<p class="text-center mt-2 caption">
				<b>TIPS :</b> Klik Tombol Open Camera, Arahkan kamera sejajar dengan QRCode dan pastikan cahaya layar cukup terang.
			</p>
		</div>
	</div>
</div>
<div class=" align-self-center content-tab-checkout-dummy" id="content-tab-checkout">
	<h1 class="text-center title-card">Take QR Code Check Out</h1>
	<h5 class="text-center date-card">Senin, 16 November 2020</h5>
	<button id="btn-qr-mobile" class="btn btn-primary text-center" onClick="initCam()" style="background: #7F8DFD;">Open Camera</button>
	<p class="text-center mt-2 caption">
		<b>TIPS :</b> Klik Tombol Open Camera, Arahkan kamera sejajar dengan QRCode dan pastikan cahaya layar cukup terang.
	</p>
</div>

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/popper.min.js"></script>
<script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/js/sweetalert.min.js"></script>
<script type="text/javascript" src="assets/js/qr_packed.js"></script>
<script type="text/javascript" src="assets/js/client.min.js"></script>
<script>
let vids;
let move = 1;
let rand = 0;
let hist = 0;
let neg = [
    { top: "-=20%", left: "-=20%" },
    { left: "-=20%", right: "-=20%" },
    { right: "-=20%", bottom: "-=20%" },
    { bottom: "-=20%", left: "-=20%" },
];
let pos = [
    { top: "+=20%", left: "+=20%" },
    { left: "+=20%", right: "+=20%" },
    { right: "+=20%", bottom: "+=20%" },
    { bottom: "+=20%", left: "+=20%" },
];
function movebg() {
    $.each($("#moving-bg"), function (index, val) {
        if (move == 1) {
            random = Math.floor(Math.random() * 4);
            $(val).animate(pos[random], 5000, "swing");
            move = 2;
        } else {
            $(val).animate(neg[random], 5000, "swing");
            move = 1;
        }
    });
}
function alerting() {
	let check = $('#active-tab').attr('data-absen');
	let alert_cap;
	let date = new Date();
	if (check == 'in') {
		alert_cap = 'Check In';
	}else if(check == 'out'){
		alert_cap = 'Check Out';
	}else{
		alert_cap = 'Check';
	}
    var bMusic = new Audio("assets/audio/smongko.mp3");
    setTimeout(() => {
        bMusic.play();
    }, 100);
    Swal.fire({ title: '<span id="cswal-title">'+alert_cap+' : '+date.getHours()+':'+date.getMinutes()+'</span>', showConfirmButton: !1, timer: 2000, icon: "success", backdrop: !1 });
}
function initCam() {
    const qrcodes = window.qrcode;
    const video = document.createElement("video");
    const canvasElement = document.getElementById("qri");
    const canvas = canvasElement.getContext("2d");
    const qrResult = document.getElementById("qr-result");
    const outputData = document.getElementById("outputData");
    let scanning = !1;
    qrcodes.callback = (res) => {
        if (res) {
            alerting();
        }
    };
    try {
        navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } }).then(function (stream) {
            scanning = !0;
            canvasElement.hidden = !1;
            video.setAttribute("playsinline", !0);
            video.srcObject = stream;
            video.play();
            vids = stream;
            tick();
            scan();
        });
        alerting();
    } catch (e) {
        alerting();
    }
    function tick() {
        canvasElement.height = video.videoHeight;
        canvasElement.width = video.videoWidth;
        canvas.drawImage(video, 0, 0, canvasElement.width, canvasElement.height);
        scanning && requestAnimationFrame(tick);
    }
    function scan() {
        try {
            qrcodes.decode();
        } catch (e) {
            setTimeout(scan, 300);
        }
    }
}
movebg();
setInterval(() => {
    movebg();
}, 5000);
$("#nav-shadow-mobile").position($("#active-tab-mobile").position());
$("#nav-shadow-mobile").width($("#active-tab-mobile").width());
$("#nav-shadow").position($("#active-tab").position());
$("#nav-shadow").width($("#active-tab").width());
$(".nav-link").click((e) => {
    let past_width = $("#active-tab").width();
    $("#profile-btn").removeClass("active-tab");
    $("#active-tab").removeAttr("id");
    let el = e.target;
    let parent = $(el).parent();
    $(parent).attr("id", "active-tab");
    let brc_h = $(".barcode").height();
    let brc_w = $(".barcode").width();
    let qri_h = "15em";
    let qri_w = "15em";
    $("#nav-shadow").animate({ width: $("#active-tab").width(), top: $("#active-tab").position().top, left: $("#active-tab").position().left, height: $("#active-tab").height() }, 200, "swing");
    $("#main-content div").animate({ opacity: 0, "margin-left": "-10em" }, 200, () => {
        let wrapper_h = $("#main-wrapper").height();
        if ($(el).attr("data-target") != "content-tab-history") {
            if (hist == 1) {
                $("#main-wrapper div").animate({ opacity: 0, visibility: "hidden" }, 200, () => {
                    $("#main-wrapper").css({ background: "none", padding: 0 }).html("");
                    $("#main-wrapper").html($("#" + $(el).attr("data-wrapper") + "-wrapper").html());
                    hist = 0;
                });
            }
            $("#main-content").html('<div class="align-self-center" style="opacity: 0; margin-left: 10em">' + $("#" + $(el).attr("data-target")).html() + "</div>");
            $("#main-content div").animate({ opacity: 1, "margin-left": 0 }, 200);
        } else {
            if (vids) {
                vids.getTracks().forEach(function (track) {
                    if (track.readyState == "live") {
                        track.stop();
                    }
                });
            }
            $("#main-wrapper").css({ height: "" });
            $("#main-wrapper div").animate({ opacity: 0, visibility: "hidden" }, 200, () => {
                $("#card-history").css({ "max-height": wrapper_h });
                $("#main-wrapper").css({ height: wrapper_h, "background-color": "#fff" }).html("");
                $("#main-wrapper").html($("#history-absen").html());
                hist = 1;
            });
        }
    });
});
$("#profile-btn").click((e) => {
    if (vids) {
        vids.getTracks().forEach(function (track) {
            if (track.readyState == "live") {
                track.stop();
            }
        });
    }
    $("#profile-btn").addClass("active-tab");
    if ($("#profile-btn").height() > 0) {
        $("#nav-shadow").animate({ width: $(".active-tab").width(), height: $(".active-tab").height(), top: $(".active-tab").position().top, left: $(".active-tab").position().left }, 200, "swing");
    } else {
        $("#nav-shadow").animate({ width: $(".img-nav").width(), height: $(".img-nav").height(), top: $(".img-nav").position().top, left: $(".img-nav").position().left }, 200, "swing");
    }
    let wrapper_h = $("#main-wrapper").height();
    $("#main-content div").animate({ opacity: 0, "margin-left": "-10em" }, 200, () => {
        let wrapper_h = $("#main-wrapper").height();
        $("#main-wrapper div").animate({ opacity: 0, visibility: "hidden" }, 200, () => {
            $("#main-wrapper").css({ height: wrapper_h, background: "none", padding: 0 }).html("");
            $("#main-wrapper").html($("#amel-wrapper").html());
            hist = 1;
        });
    });
});
$(window).resize(() => {
    let cact_tab = $(".active-tab").length;
    let cact_tab_w = $(".active-tab").height();
    let shadow_w = cact_tab > 0 ? (cact_tab_w > 0 ? $(".active-tab").width() : $(".img-nav").width()) : $("#active-tab").width(),
        shadow_h = cact_tab > 0 ? (cact_tab_w > 0 ? $(".active-tab").height() : $(".img-nav").height()) : $("#active-tab").height(),
        shadow_t = cact_tab > 0 ? (cact_tab_w > 0 ? $(".active-tab").position().top : $(".img-nav").position().top) : $("#active-tab").position().top,
        shadow_l = cact_tab > 0 ? (cact_tab_w > 0 ? $(".active-tab").position().left : $(".img-nav").position().left) : $("#active-tab").position().left;
    $("#nav-shadow").css({ width: shadow_w, height: shadow_h, top: shadow_t, left: shadow_l });
    $(".barcode").css({ width: "", height: "" });
    $("#qri").css({ width: "", height: "" });
    $("#main-wrapper").css({ height: "" });
});

</script>
</html>