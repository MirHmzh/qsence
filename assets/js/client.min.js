let vids;let move=1;let rand=0;let hist=0;let neg=[{top:"-=20%",left:"-=20%"},{left:"-=20%",right:"-=20%"},{right:"-=20%",bottom:"-=20%"},{bottom:"-=20%",left:"-=20%"},];let pos=[{top:"+=20%",left:"+=20%"},{left:"+=20%",right:"+=20%"},{right:"+=20%",bottom:"+=20%"},{bottom:"+=20%",left:"+=20%"},];function movebg(){$.each($("#moving-bg"),function(index,val){if(move==1){random=Math.floor(Math.random()*4);$(val).animate(pos[random],5000,"swing");move=2}else{$(val).animate(neg[random],5000,"swing");move=1}})}
function alerting(){var bMusic=new Audio("assets/audio/smongko.mp3");setTimeout(()=>{bMusic.play()},100);Swal.fire({title:'<span id="cswal-title">Check In : 07:00</span>',showConfirmButton:!1,timer:2000,icon:"success",backdrop:!1})}
function initCam(){const qrcodes=window.qrcode;const video=document.createElement("video");const canvasElement=document.getElementById("qri");const canvas=canvasElement.getContext("2d");const qrResult=document.getElementById("qr-result");const outputData=document.getElementById("outputData");let scanning=!1;qrcodes.callback=(res)=>{if(res){alert(res+" absen")}};try{navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(function(stream){scanning=!0;canvasElement.hidden=!1;video.setAttribute("playsinline",!0);video.srcObject=stream;video.play();vids=stream;tick();scan()});alerting()}catch(e){alerting()}
function tick(){canvasElement.height=video.videoHeight;canvasElement.width=video.videoWidth;canvas.drawImage(video,0,0,canvasElement.width,canvasElement.height);scanning&&requestAnimationFrame(tick)}
function scan(){try{qrcodes.decode()}catch(e){setTimeout(scan,300)}}}
movebg();setInterval(()=>{movebg()},5000);$("#nav-shadow-mobile").position($("#active-tab-mobile").position());$("#nav-shadow-mobile").width($("#active-tab-mobile").width());$("#nav-shadow").position($("#active-tab").position());$("#nav-shadow").width($("#active-tab").width());$(".nav-link").click((e)=>{let past_width=$("#active-tab").width();$("#profile-btn").removeClass("active-tab");$("#active-tab").removeAttr("id");let el=e.target;let parent=$(el).parent();$(parent).attr("id","active-tab");let brc_h=$(".barcode").height();let brc_w=$(".barcode").width();let qri_h="15em";let qri_w="15em";$("#nav-shadow").animate({width:$("#active-tab").width(),top:$("#active-tab").position().top,left:$("#active-tab").position().left,height:$("#active-tab").height()},200,"swing");$("#main-content div").animate({opacity:0,"margin-left":"-10em"},200,()=>{let wrapper_h=$("#main-wrapper").height();if($(el).attr("data-target")!="content-tab-history"){if(hist==1){$("#main-wrapper div").animate({opacity:0,visibility:"hidden"},200,()=>{$("#main-wrapper").css({background:"none",padding:0}).html("");$("#main-wrapper").html($("#"+$(el).attr("data-wrapper")+"-wrapper").html());hist=0})}
$("#main-content").html('<div class="align-self-center" style="opacity: 0; margin-left: 10em">'+$("#"+$(el).attr("data-target")).html()+"</div>");$("#main-content div").animate({opacity:1,"margin-left":0},200)}else{if(vids){vids.getTracks().forEach(function(track){if(track.readyState=="live"){track.stop()}})}
$("#main-wrapper").css({height:""});$("#main-wrapper div").animate({opacity:0,visibility:"hidden"},200,()=>{$("#card-history").css({"max-height":wrapper_h});$("#main-wrapper").css({height:wrapper_h,"background-color":"#fff"}).html("");$("#main-wrapper").html($("#history-absen").html());hist=1})}})});$("#profile-btn").click((e)=>{if(vids){vids.getTracks().forEach(function(track){if(track.readyState=="live"){track.stop()}})}
$("#profile-btn").addClass("active-tab");if($('#profile-btn').height()>0){$("#nav-shadow").animate({width:$(".active-tab").width(),height:$(".active-tab").height(),top:$(".active-tab").position().top,left:$(".active-tab").position().left},200,"swing")}else{$("#nav-shadow").animate({width:$(".img-nav").width(),height:$(".img-nav").height(),top:$(".img-nav").position().top,left:$(".img-nav").position().left},200,"swing")}
let wrapper_h=$("#main-wrapper").height();$("#main-content div").animate({opacity:0,"margin-left":"-10em"},200,()=>{let wrapper_h=$("#main-wrapper").height();$("#main-wrapper div").animate({opacity:0,visibility:"hidden"},200,()=>{$("#main-wrapper").css({height:wrapper_h,background:"none",padding:0}).html("");$("#main-wrapper").html($("#amel-wrapper").html());hist=1})})});$(window).resize(()=>{let cact_tab=$(".active-tab").length;let cact_tab_w=$(".active-tab").height();let shadow_w=cact_tab>0?(cact_tab_w>0?$(".active-tab").width():$(".img-nav").width()):$("#active-tab").width(),shadow_h=cact_tab>0?(cact_tab_w>0?$(".active-tab").height():$(".img-nav").height()):$("#active-tab").height(),shadow_t=cact_tab>0?(cact_tab_w>0?$(".active-tab").position().top:$(".img-nav").position().top):$("#active-tab").position().top,shadow_l=cact_tab>0?(cact_tab_w>0?$(".active-tab").position().left:$(".img-nav").position().left):$("#active-tab").position().left;$("#nav-shadow").css({width:shadow_w,height:shadow_h,top:shadow_t,left:shadow_l});$(".barcode").css({width:"",height:""});$("#qri").css({width:"",height:""});$("#main-wrapper").css({height:""})})